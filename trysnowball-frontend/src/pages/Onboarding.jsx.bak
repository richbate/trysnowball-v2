/**
 * Onboarding Wizard - First-time user debt setup
 * Guides users through adding their first debts
 */

import React from 'react';
import { useNavigate } from 'react-router-dom';
import { useDemoMode } from '../providers/DemoModeProvider';
import { Plus, TrendingUp, Sparkles } from 'lucide-react';
import PrivacySecurityBanner from '../components/PrivacySecurityBanner';
import { capture } from '../utils/analytics';

const Onboarding = () => {
 const navigate = useNavigate();
 const { enterDemo } = useDemoMode();
 
 const handleTryDemo = async () => {
  await enterDemo('onboarding', 'uk');
  navigate('/');
 };
 

 return (
  <div className="min-h-screen bg-gradient-to-br from-primary via-accent to-primary">
   <div className="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    
    {/* Progress indicator */}
    <div className="mb-8">
     <div className="flex items-center justify-between mb-2">
      <span className="text-sm font-medium text-white/90">Getting Started</span>
      <span className="text-sm text-white/70">0 debts added</span>
     </div>
     <div className="w-full bg-white/20 rounded-full h-3">
      <div className="bg-white h-3 rounded-full w-1/3 shadow-sm" />
     </div>
    </div>

    {/* Welcome step - Elevated card */}
    <div className="bg-white/95 backdrop-blur-lg rounded-3xl shadow-2xl p-10">
      <div className="text-center mb-8">
       <div className="w-20 h-20 bg-secondary rounded-full flex items-center justify-center mx-auto mb-6">
        <TrendingUp className="w-10 h-10 text-primary" />
       </div>
       <h1 className="text-4xl font-black text-gray-900 mb-4">
        Welcome to TrySnowball! 🎯
       </h1>
       <p className="text-xl text-gray-700 mb-2 font-medium">
        Let's set up your debt payoff plan
       </p>
       <p className="text-gray-500">
        Add your debts to see when you'll be debt-free and how much you'll save.
       </p>
      </div>
      
      <div className="space-y-4">
       <button
        onClick={() => {
         // Emit analytics
         capture('onboarding_add_debt_clicked');
         // Mark onboarding as done to fix future redirects
         localStorage.setItem('ts:onboarding_done', 'true');
         // Navigate to debt plan with URL parameter to trigger add modal
         navigate('/plan/debts?add=true');
        }}
        className="w-full px-8 py-5 bg-primary text-white rounded-2xl text-xl font-bold hover:bg-violet-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 flex items-center justify-center gap-3"
       >
        <Plus className="w-6 h-6" />
        🚀 Add My First Debt
       </button>
       
       <button
        onClick={handleTryDemo}
        className="w-full px-8 py-4 bg-secondary text-primary rounded-2xl text-lg font-semibold hover:bg-violet-100 transition-all duration-200 border-2 border-primary/20 flex items-center justify-center gap-3"
       >
        <Sparkles className="w-5 h-5 text-accent" />
        Show Me Demo Data First
       </button>
      </div>
     </div>

   </div>
   
   {/* Privacy & Security Banner - Fixed bottom-right toast */}
   <div className="fixed bottom-4 right-4 max-w-sm z-40">
    <div className="bg-white/90 backdrop-blur rounded-xl shadow-2xl p-4 text-sm border border-gray-200">
     <div className="flex items-start gap-2">
      <div className="text-green-600 text-lg">🔐</div>
      <div>
       <div className="font-semibold text-gray-900 mb-1">Your data is safe</div>
       <div className="text-gray-700 text-xs leading-relaxed">
        Fully encrypted and stored in the EU. Never sold.
       </div>
      </div>
     </div>
    </div>
   </div>
   
  </div>
 );
};

export default Onboarding;